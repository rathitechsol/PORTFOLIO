<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Portfolio - Windows XP Style</title>
    <!-- Pixelated font from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --xp-blue: #0A246A;
            --xp-dark-blue: #000080;
            --xp-light-blue: #1A54E1;
            --xp-gray: #ECE9D8;
            --xp-dark-gray: #A4A4A4;
            --xp-green: #3D9140;
            --xp-red: #D20000;
            --xp-yellow: #FDD100;
            --xp-font: 'Press Start 2P', cursive;
        }

        /* Basic Page Styles */
        body {
            font-family: 'Press Start 2P', cursive;
            margin: 0;
            padding: 0;
            overflow: hidden;
            color: black;
            cursor: url('https://raw.githubusercontent.com/jdan/98.css/main/docs/cursors/winxp.cur'), auto;
            background-color: var(--xp-blue); 
            background-image: url('wing.jpg'); 
            background-size: cover;
        }

        /* Boot-up Screen */
        .boot-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            color: white;
            font-size: 1.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 100;
            transition: opacity 1s;
        }

        .boot-screen h1 {
            font-size: 2rem;
            margin-bottom: 2rem;
            text-shadow: 2px 2px #000;
        }

        .loading-bar-container {
            width: 300px;
            height: 20px;
            border: 2px solid white;
            padding: 2px;
            box-shadow: inset 0 0 0 2px black;
        }

        .loading-bar {
            height: 100%;
            background-color: white;
            width: 0;
            transition: width 0.5s linear;
        }

        /* BSOD Screen */
        .bsod {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--xp-dark-blue);
            color: white;
            font-size: 1rem;
            display: none;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            padding: 2rem;
            z-index: 101;
            font-family: monospace;
        }
        .bsod-text {
            white-space: pre-wrap;
            line-height: 1.5;
            text-shadow: 1px 1px #000;
        }

        /* Desktop Layout */
        #desktop {
            display: none;
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        /* Taskbar */
        #taskbar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 32px;
            background: linear-gradient(to right, var(--xp-dark-blue), var(--xp-light-blue));
            border-top: 2px solid var(--xp-dark-gray);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 4px;
            box-sizing: border-box;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        #start-button {
            background: linear-gradient(to right, var(--xp-green), #3D7A40);
            border: 2px outset var(--xp-dark-gray);
            border-radius: 4px;
            padding: 2px 8px;
            height: 28px;
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        #start-button:active {
            border-style: inset;
        }

        #taskbar-time {
            color: white;
            padding: 0 8px;
            text-shadow: 1px 1px black;
        }

        /* Start Menu */
        #start-menu {
            position: absolute;
            bottom: 32px;
            left: 0;
            width: 200px;
            background-color: var(--xp-gray);
            border: 2px outset var(--xp-dark-gray);
            display: none;
            flex-direction: column;
            padding: 8px;
            box-shadow: 4px 4px 0 black;
            z-index: 50;
        }

        .start-menu-item {
            padding: 4px;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .start-menu-item:hover {
            background-color: var(--xp-light-blue);
            color: white;
            border: 2px dotted white;
        }

        /* Desktop Icons */
        .desktop-icons {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .desktop-icon {
            text-align: center;
            width: 80px;
            cursor: pointer;
            color: white;
            text-shadow: 1px 1px black;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .desktop-icon .icon-svg {
            width: 32px;
            height: 32px;
            fill: white;
            image-rendering: pixelated;
        }

        .desktop-icon img {
            width: 32px;
            height: 32px;
            image-rendering: pixelated;
        }

        .desktop-icon-label {
            font-size: 0.7rem;
            margin-top: 4px;
        }
        
        /* Window Styles */
        .window {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 500px;
            min-height: 300px;
            background-color: var(--xp-gray);
            border: 2px solid var(--xp-dark-gray);
            box-shadow: 4px 4px 0 black;
            display: none;
            flex-direction: column;
        }

        .window-title-bar {
            height: 24px;
            background: linear-gradient(to right, var(--xp-blue), var(--xp-dark-blue));
            color: white;
            padding: 0 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: grab;
            border-bottom: 2px solid var(--xp-dark-gray);
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        .window-title-bar:active {
            cursor: grabbing;
        }

        .window-title {
            font-size: 0.8rem;
            text-shadow: 1px 1px black;
        }

        .window-controls {
            display: flex;
            gap: 2px;
        }

        .window-controls button {
            width: 20px;
            height: 20px;
            background-color: var(--xp-gray);
            border: 2px outset var(--xp-dark-gray);
            padding: 0;
            font-size: 0.8rem;
            cursor: pointer;
        }
        
        .window-controls button.close-btn {
            background-color: var(--xp-red);
            color: white;
            font-weight: bold;
        }

        .window-content {
            padding: 16px;
            flex-grow: 1;
            overflow-y: auto;
            border-top: 2px solid white;
        }
        
        .window-content p {
            line-height: 1.5;
            font-size: 0.9rem;
        }
        
        /* Command Prompt */
        .cmd-window .window-content {
            background-color: black;
            color: #00FF00;
            font-family: monospace;
            overflow-y: auto;
            border-top: none;
            font-size: 0.9rem;
        }
        .cmd-output {
            white-space: pre-wrap;
            line-height: 1.2;
        }
        .cmd-input-line {
            display: flex;
        }
        .cmd-input {
            background-color: transparent;
            border: none;
            color: #00FF00;
            font-family: monospace;
            outline: none;
            width: 100%;
        }

        /* Context Menu */
        #context-menu {
            position: absolute;
            background-color: var(--xp-gray);
            border: 2px outset var(--xp-dark-gray);
            padding: 2px;
            display: none;
            flex-direction: column;
            z-index: 60;
        }

        .context-menu-item {
            padding: 4px 12px;
            font-size: 0.8rem;
            cursor: pointer;
        }

        .context-menu-item:hover {
            background-color: var(--xp-light-blue);
            color: white;
        }

    </style>
</head>
<body>

    <!-- Boot-up Sequence -->
    <div id="boot-screen" class="boot-screen">
        <h1>Loading...</h1>
        <div class="loading-bar-container">
            <div id="loading-bar" class="loading-bar"></div>
        </div>
    </div>

    <!-- BSOD Easter Egg -->
    <div id="bsod-screen" class="bsod">
        <p class="bsod-text">
            A problem has been detected and Windows has been shut down to prevent damage<br>
            to your computer.<br><br>
            
            The problem seems to be caused by the following file: PORTFOLIO.SYS<br>
            PAGE_FAULT_IN_NONPAGED_AREA<br><br>

            If this is the first time you've seen this Stop error screen,<br>
            restart your computer. If this screen appears again, follow<br>
            these steps:<br><br>

            Check to make sure any new hardware or software is properly installed.<br>
            If this is a new installation, ask your hardware or software manufacturer<br>
            for any Windows updates you might need.<br><br>

            If problems continue, disable or remove any newly installed hardware<br>
            or software. Disable BIOS memory options such as caching or shadowing.<br>
            If you need to use Safe Mode to remove or disable components, restart<br>
            your computer, press F8 to select Advanced Startup Options, and then<br>
            select Safe Mode.<br><br>

            Technical Information:<br>
            <br>
            *** STOP: 0x00000050 (0xFED55321, 0x00000001, 0xFD46B4E5, 0x00000000)<br><br>

            Beginning dump of physical memory<br>
            Physical memory dump complete.<br>
            Contact your system administrator or technical support group for further<br>
            assistance.<br>
        </p>
    </div>

    <!-- Main Desktop -->
    <div id="desktop">

        <!-- Taskbar -->
        <div id="taskbar">
            <button id="start-button">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23FFF'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15.02h2v-2h-2v2zm0-4h2v-4h-2v4z'/%3E%3C/svg%3E" alt="Start" style="height: 16px; width: 16px; margin-right: 4px; image-rendering: pixelated;">
                Start
            </button>
            <div id="taskbar-time"></div>
        </div>

        <!-- Start Menu -->
        <div id="start-menu">
            <div class="start-menu-item" data-target="about-window">About Me</div>
            <div class="start-menu-item" data-target="projects-window">Projects</div>
            <div class="start-menu-item" data-target="contact-window">Contact Me</div>
            <div class="start-menu-item" data-target="gallery-window">Gallery</div>
            <div class="start-menu-item" data-target="cmd-window">Command Prompt</div>
            <div class="start-menu-item" id="bsod-trigger-start">BSOD</div>
        </div>

        <!-- Desktop Icons -->
        <div class="desktop-icons">
            <div class="desktop-icon" id="about-icon" data-target="about-window">
                <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                <div class="desktop-icon-label">About Me</div>
            </div>
            <div class="desktop-icon" id="projects-icon" data-target="projects-window">
                <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2h-4zM4 6h16v10H4V6z"/></svg>
                <div class="desktop-icon-label">Projects</div>
            </div>
            <div class="desktop-icon" id="contact-icon" data-target="contact-window">
                <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.2.09-.4.09-.6s-.04-.4-.09-.6l7.05-4.11c.52.47 1.2.77 1.96.77 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .2.04.4.09.6L8.14 9.17c-.52-.47-1.2-.77-1.96-.77-1.66 0-3 1.34-3 3s1.34 3 3 3c.76 0 1.44-.3 1.96-.77l7.05 4.11c-.05.2-.09.4-.09.6 0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3z"/></svg>
                <div class="desktop-icon-label">Contact Me</div>
            </div>
            <div class="desktop-icon" id="gallery-icon" data-target="gallery-window">
                <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/></svg>
                <div class="desktop-icon-label">Gallery</div>
            </div>
            <div class="desktop-icon" id="cmd-icon" data-target="cmd-window">
                <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h16v12zM6 8l4 4-4 4V8zM15 17h3v-2h-3v2z"/></svg>
                <div class="desktop-icon-label">Command Prompt</div>
            </div>
        </div>
        
        <!-- Context Menu -->
        <div id="context-menu">
            <div class="context-menu-item" id="refresh-desktop">Refresh</div>
            <div class="context-menu-item" id="new-window-btn">New Window</div>
            <div class="context-menu-item" id="open-all-windows">Open All</div>
        </div>

        <!-- Portfolio Windows -->
        <div id="about-window" class="window" style="z-index: 10;">
            <div class="window-title-bar">
                <span class="window-title">About Me</span>
                <div class="window-controls">
                    <button class="close-btn" data-target="about-window">X</button>
                </div>
            </div>
            <div class="window-content">
                <h2>Hello! I'm Daksh Rathi.</h2>
                <p>Welcome to my pixelated Windows XP-themed portfolio. This site is a showcase of my skills in web development, built with a love for retro aesthetics and vanilla JavaScript. Everything you see here—from the draggable windows to the pixelated interface—was crafted using only HTML, CSS, and JS. I am a full-stack developer with a passion for creating unique and interactive user experiences. My expertise includes building dynamic web applications, designing responsive interfaces, and solving complex problems with clean, efficient code.</p>
                <p>Feel free to explore the other sections by clicking the icons on the desktop. To learn more about my skills and experience, check out my resume.</p>
            </div>
        </div>

        <div id="projects-window" class="window" style="z-index: 9;">
            <div class="window-title-bar">
                <span class="window-title">Projects</span>
                <div class="window-controls">
                    <button class="close-btn" data-target="projects-window">X</button>
                </div>
            </div>
            <div class="window-content">
                <h2>My Work</h2>
                <p>Here are a few of my recent projects:</p>
                <ul>
                    <li><strong>One Piece College Helper:</strong> A Simple b=yet effective college tool that helps to combine all aspecrts of a college in a single place.Its easy to use and can be implemented as per the users requirement .</li>
                    <li><strong>Resume Builder:</strong> An interactive, text-based REsume building experience.</li>
                </ul>
            </div>
        </div>

        <div id="contact-window" class="window" style="z-index: 8;">
            <div class="window-title-bar">
                <span class="window-title">Contact Me</span>
                <div class="window-controls">
                    <button class="close-btn" data-target="contact-window">X</button>
                </div>
            </div>
            <div class="window-content">
                <h2>Get in Touch</h2>
                <p>You can reach me at:</p>
                <ul>
                    <li>Email: <a href="dakshrathi911@gmail.com">dakshrathi911@gmail.com</a></li>
                    <li>GitHub: <a href="https://github.com/rathtiechsol" target="_blank">github.com/rathitechsol</a></li>
                    <li>LinkedIn: <a href="https://www.linkedin.com/in/daksh-rathi-839396296/" target="_blank">https://www.linkedin.com/in/daksh-rathi-839396296/</a></li>
                </ul>
            </div>
        </div>

        <div id="gallery-window" class="window" style="z-index: 7;">
            <div class="window-title-bar">
                <span class="window-title">Gallery</span>
                <div class="window-controls">
                    <button class="close-btn" data-target="gallery-window">X</button>
                </div>
            </div>
            <div class="window-content">
                <h2>Design & Art</h2>
                <p>Here are some examples of my design work, showcasing a mix of digital art and UI/UX projects.</p>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                    <img src="https://placehold.co/150x150/000080/FFFFFF?text=Pixel+Art+1" alt="Pixel Art 1" style="image-rendering: pixelated; border: 2px solid black;">
                    <img src="https://placehold.co/150x150/800080/FFFFFF?text=UI+Design" alt="UI Design" style="image-rendering: pixelated; border: 2px solid black;">
                    <img src="https://placehold.co/150x150/008080/FFFFFF?text=Pixel+Art+2" alt="Pixel Art 2" style="image-rendering: pixelated; border: 2px solid black;">
                </div>
            </div>
        </div>

        <div id="cmd-window" class="window cmd-window" style="z-index: 6;">
            <div class="window-title-bar">
                <span class="window-title">C:\WINDOWS\system32\cmd.exe</span>
                <div class="window-controls">
                    <button class="close-btn" data-target="cmd-window">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="cmd-output">
                    dakshrathi.beta loaded[Version 0.1.26]<br>
                    (C) Copyright 2023-2027 Daksh Rathi.<br><br>
                </div>
                <div class="cmd-input-line">
                    <span class="prompt">C:\&gt;</span>
                    <input type="text" class="cmd-input" autofocus>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio elements for sound effects -->
    <audio id="open-sound" src="https://www.soundjay.com/button/button-1.mp3" preload="auto"></audio>
    <audio id="close-sound" src="https://www.soundjay.com/button/button-2.mp3" preload="auto"></audio>
    <audio id="bsod-sound" src="https://www.soundjay.com/misc/fail-buzzer-01.mp3" preload="auto"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const bootScreen = document.getElementById('boot-screen');
            const loadingBar = document.getElementById('loading-bar');
            const desktop = document.getElementById('desktop');
            const taskbarTime = document.getElementById('taskbar-time');
            const startButton = document.getElementById('start-button');
            const startMenu = document.getElementById('start-menu');
            const windows = document.querySelectorAll('.window');
            const desktopIcons = document.querySelectorAll('.desktop-icon');
            const startMenuItems = document.querySelectorAll('.start-menu-item');
            const closeButtons = document.querySelectorAll('.close-btn');
            const cmdWindow = document.getElementById('cmd-window');
            const cmdInput = cmdWindow.querySelector('.cmd-input');
            const cmdOutput = cmdWindow.querySelector('.cmd-output');
            const bsodTriggerStart = document.getElementById('bsod-trigger-start');
            const bsodScreen = document.getElementById('bsod-screen');
            const contextMenu = document.getElementById('context-menu');
            const refreshDesktopBtn = document.getElementById('refresh-desktop');
            const newWindowBtn = document.getElementById('new-window-btn');
            const openAllWindowsBtn = document.getElementById('open-all-windows');
            const openSound = document.getElementById('open-sound');
            const closeSound = document.getElementById('close-sound');
            const bsodSound = document.getElementById('bsod-sound');

            let zIndexCounter = 10;
            let currentWindow = null;

            // Boot-up animation
            const bootSequence = () => {
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 10;
                    loadingBar.style.width = progress + '%';
                    if (progress >= 100) {
                        clearInterval(interval);
                        setTimeout(() => {
                            bootScreen.style.opacity = 0;
                            setTimeout(() => {
                                bootScreen.style.display = 'none';
                                desktop.style.display = 'block';
                            }, 1000);
                        }, 500);
                    }
                }, 100);
            };

            // Update Taskbar Time
            const updateTime = () => {
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const ampm = hours >= 12 ? 'PM' : 'AM';
                taskbarTime.textContent = `${hours % 12 || 12}:${minutes} ${ampm}`;
            };
            setInterval(updateTime, 1000);
            updateTime();

            // Handle window bringing to front
            const bringToFront = (windowElement) => {
                if (windowElement && windowElement.style.display === 'block') {
                    zIndexCounter++;
                    windowElement.style.zIndex = zIndexCounter;
                }
            };
            
            // Toggle Start Menu
            startButton.addEventListener('click', (e) => {
                e.stopPropagation();
                startMenu.style.display = startMenu.style.display === 'block' ? 'none' : 'flex';
            });

            // Hide Start Menu and Context Menu when clicking elsewhere
            document.addEventListener('click', (e) => {
                if (!startMenu.contains(e.target) && e.target !== startButton) {
                    startMenu.style.display = 'none';
                }
                if (!contextMenu.contains(e.target)) {
                    contextMenu.style.display = 'none';
                }
            });

            // Handle desktop icon clicks
            const openWindow = (targetId) => {
                const targetWindow = document.getElementById(targetId);
                if (targetWindow) {
                    targetWindow.style.display = 'block';
                    bringToFront(targetWindow);
                    try { openSound.play(); } catch(e) { console.error("Could not play sound:", e); }
                }
            };

            desktopIcons.forEach(icon => {
                icon.addEventListener('click', (e) => {
                    const targetId = icon.dataset.target;
                    openWindow(targetId);
                    e.stopPropagation();
                });
            });

            startMenuItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    const targetId = item.dataset.target;
                    openWindow(targetId);
                    startMenu.style.display = 'none';
                });
            });

            // Close window functionality
            closeButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetId = button.dataset.target;
                    const targetWindow = document.getElementById(targetId);
                    if (targetWindow) {
                        targetWindow.style.display = 'none';
                        try { closeSound.play(); } catch(e) { console.error("Could not play sound:", e); }
                    }
                });
            });

            // Make windows draggable
            windows.forEach(win => {
                const titleBar = win.querySelector('.window-title-bar');
                let isDragging = false;
                let offsetX, offsetY;
                
                win.addEventListener('mousedown', () => bringToFront(win));

                titleBar.addEventListener('mousedown', (e) => {
                    isDragging = true;
                    offsetX = e.clientX - win.offsetLeft;
                    offsetY = e.clientY - win.offsetTop;
                    titleBar.style.cursor = 'grabbing';
                    e.preventDefault();
                });

                document.addEventListener('mousemove', (e) => {
                    if (isDragging) {
                        win.style.left = (e.clientX - offsetX) + 'px';
                        win.style.top = (e.clientY - offsetY) + 'px';
                    }
                });

                document.addEventListener('mouseup', () => {
                    isDragging = false;
                    titleBar.style.cursor = 'grab';
                });
            });

            // Command Prompt functionality
            cmdInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    const command = cmdInput.value.toLowerCase().trim();
                    const outputLine = `C:\\&gt;${command}\n`;
                    
                    let response = '';
                    switch(command) {
                        case 'about':
                            response = "Hello! I'm your name. I built this retro portfolio using vanilla HTML, CSS, and JS. I'm a developer with a passion for creative and interactive web experiences.";
                            openWindow('about-window');
                            break;
                        case 'projects':
                            response = "To view my projects, please open the 'Projects' window.";
                            openWindow('projects-window');
                            break;
                        case 'contact':
                            response = "You can find my contact information in the 'Contact Me' window.";
                            openWindow('contact-window');
                            break;
                        case 'clear':
                            cmdOutput.innerHTML = 'Microsoft Windows [Version 5.1.2600]<br>(C) Copyright 1985-2001 Microsoft Corp.<br><br>';
                            response = '';
                            break;
                        case 'help':
                            response = 'Available commands: about, projects, contact, clear, bsod, and help.';
                            break;
                        case 'bsod':
                            showBsod();
                            break;
                        default:
                            response = ` '${command}' is not recognized as an internal or external command, operable program or batch file.`;
                            break;
                    }

                    cmdOutput.textContent += outputLine + response + '\n\n';
                    cmdInput.value = '';
                    cmdOutput.scrollTop = cmdOutput.scrollHeight;
                }
            });

            // BSOD Easter Egg
            const showBsod = () => {
                desktop.style.display = 'none';
                bsodScreen.style.display = 'flex';
                try { bsodSound.play(); } catch(e) { console.error("Could not play sound:", e); }
                setTimeout(() => {
                    bsodScreen.style.display = 'none';
                    desktop.style.display = 'block';
                }, 5000);
            };

            bsodTriggerStart.addEventListener('click', showBsod);

            // Right-click context menu
            document.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                contextMenu.style.display = 'flex';
                contextMenu.style.left = `${e.clientX}px`;
                contextMenu.style.top = `${e.clientY}px`;
            });

            // Context Menu actions
            refreshDesktopBtn.addEventListener('click', () => {
                location.reload();
            });

            newWindowBtn.addEventListener('click', () => {
                // Example of creating a new generic window
                const newWindow = document.createElement('div');
                newWindow.classList.add('window');
                newWindow.innerHTML = `
                    <div class="window-title-bar">
                        <span class="window-title">New Window</span>
                        <div class="window-controls">
                            <button class="close-btn">X</button>
                        </div>
                    </div>
                    <div class="window-content">
                        <p>This is a new window created dynamically.</p>
                    </div>
                `;
                document.getElementById('desktop').appendChild(newWindow);
                newWindow.style.display = 'block';
                bringToFront(newWindow);
                const newCloseBtn = newWindow.querySelector('.close-btn');
                const newTitleBar = newWindow.querySelector('.window-title-bar');
                
                newCloseBtn.addEventListener('click', () => {
                    newWindow.style.display = 'none';
                });

                // Re-apply drag logic for new window
                let isDragging = false;
                let offsetX, offsetY;

                newTitleBar.addEventListener('mousedown', (e) => {
                    isDragging = true;
                    offsetX = e.clientX - newWindow.offsetLeft;
                    offsetY = e.clientY - newWindow.offsetTop;
                    newTitleBar.style.cursor = 'grabbing';
                    e.preventDefault();
                });

                document.addEventListener('mousemove', (e) => {
                    if (isDragging) {
                        newWindow.style.left = (e.clientX - offsetX) + 'px';
                        newWindow.style.top = (e.clientY - offsetY) + 'px';
                    }
                });

                document.addEventListener('mouseup', () => {
                    isDragging = false;
                    newTitleBar.style.cursor = 'grab';
                });
            });

            openAllWindowsBtn.addEventListener('click', () => {
                windows.forEach(win => {
                    win.style.display = 'block';
                    bringToFront(win);
                });
            });

            // Start the boot-up process
            bootSequence();
        });
    </script>
</body>
</html>
